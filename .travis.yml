os: osx

before_script:
  - brew cask install microsoft-office

script:
  - mkdir Fonts
  - FONT_DIR=$(/Applications/Microsoft\ OneNote.app/Contents/Resources/ | ls -d */ | grep -i "fonts")
  - cp -av /Applications/Microsoft\ OneNote.app/Contents/Resources/${FONT_DIR}/* ./Fonts/
  - cp -av /Applications/Microsoft\ Word.app/Contents/Resources/${FONT_DIR}/* ./Fonts/

after_script:
  - cd Fonts
  - git init
  - git config user.name "SomeBlu"
  - git config user.email "webmaster@someblu.com"
  - git add .
  - git commit -m "Update"
  - git push --force --quiet "https://${GH_TOKEN}@${GH_REF}" master:master

branches:
  only:
    - source

env:
  global:
    - GH_REF: github.com/someblu/Microsoft-Fonts

notifications:
  email:
    - webmaster@someblu.com
  on_success: change
  on_failure: always
